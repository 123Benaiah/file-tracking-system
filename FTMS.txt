LARAVEL FILE TRACKING SYSTEM - TERMINAL AI AGENT GUIDE
ðŸ“‹ PROJECT OVERVIEW
Objective: Build a Ministry of Home Affairs (MOHA) File Tracking System for 50+ users on local office network

Core Requirements:

Track physical/digital files moving between departments

Files start and end at Registry department

One person receives notification to confirm receipt

Employees identified by: Employee Number, Name, Position, Department

Files have: SUBJECT, FILE TITLE, OLD FILE NO, NEW FILE NO

Timestamps for sent/received files

50+ concurrent users on same network

ðŸŽ¯ CRITICAL TECHNICAL SPECIFICATIONS
1. Tech Stack
text
Backend: Laravel 10.x (PHP 8.1+)
Frontend: Livewire 3.x + Blade + Tailwind CSS
Database: MySQL 8.0 (for production) / SQLite (for development)
Authentication: Laravel Breeze with Employee Number login
2. Database Schema - CORE TABLES
sql
-- Employees table - PRIMARY authentication
employee_number (PK, string) - NOT email
name, position, department, office
role: registry_head, registry_clerk, department_head, user
is_active (boolean)

-- Files table
subject, file_title, old_file_no, new_file_no (unique)
status: at_registry, in_transit, received, returned_to_registry
priority: normal, urgent, very_urgent
confidentiality: public, confidential, secret
current_holder (FK to employees)
registered_by (FK to employees)

-- File Movements table - MOST IMPORTANT
file_id (FK), sender_emp_no, intended_receiver_emp_no
actual_receiver_emp_no (null until confirmed)
sent_at, received_at (timestamps)
movement_status: sent, received, acknowledged
delivery_method: internal_messenger, hand_carry, courier
3. KEY BUSINESS LOGIC
A. File Flow:

Registry creates file â†’ status: at_registry

Registry sends to department â†’ status: in_transit

Department receives â†’ status: received (only intended person confirms)

Department processes/forwards

File returns to Registry â†’ status: returned_to_registry

B. Authentication Flow:

Login with Employee Number (not email)

Password validation

Role-based access control

C. Notification Logic:

Only ONE intended receiver gets notification

Receiver must confirm receipt

System records exact timestamp of confirmation

4. LOCAL NETWORK DEPLOYMENT REQUIREMENTS
Network Setup:

text
Server PC (192.168.1.100)
â”œâ”€â”€ Laravel Application
â”œâ”€â”€ MySQL Database
â”œâ”€â”€ All on Windows Server/Ubuntu
â””â”€â”€ Accessible via http://192.168.1.100
Requirements:

No internet required after setup

Works on office LAN only

50+ concurrent users

Fast local network speeds

5. PRIORITY FEATURES (MVP)
Phase 1 - MUST HAVE:

âœ… Employee authentication (Employee Number + Password)

âœ… File registration (Registry Head only)

âœ… File sending with single recipient notification

âœ… File receipt confirmation

âœ… File tracking with audit trail

âœ… Registry dashboard

Phase 2 - NICE TO HAVE:

QR code generation for physical files

PDF reports

Email notifications

Department dashboards

Advanced search/filtering

6. FILE STRUCTURE TO CREATE
text
app/
â”œâ”€â”€ Models/
â”‚   â”œâ”€â”€ Employee.php (extends Authenticatable)
â”‚   â”œâ”€â”€ File.php
â”‚   â”œâ”€â”€ FileMovement.php
â”‚   â””â”€â”€ AuditLog.php
â”œâ”€â”€ Livewire/
â”‚   â”œâ”€â”€ Dashboard/RegistryDashboard.php
â”‚   â”œâ”€â”€ Files/CreateFile.php
â”‚   â”œâ”€â”€ Files/SendFile.php
â”‚   â””â”€â”€ Files/ReceiveFiles.php
â””â”€â”€ Http/
    â”œâ”€â”€ Middleware/ (Role-based access)
    â””â”€â”€ Controllers/Auth/ (Modified for employee_number)
7. CRITICAL CODE MODIFICATIONS
A. Authentication Changes:

php
// app/Models/Employee.php
protected $primaryKey = 'employee_number';
public $incrementing = false;
protected $keyType = 'string';

// app/Http/Controllers/Auth/AuthenticatedSessionController.php
$credentials = [
    'employee_number' => $request->employee_number,
    'password' => $request->password,
    'is_active' => true,
];
B. File Movement Logic:

php
// When sending file
FileMovement::create([
    'intended_receiver_emp_no' => $receiverId, // ONLY this person notified
    'movement_status' => 'sent',
]);

// When receiving file
FileMovement::where('intended_receiver_emp_no', auth()->id())
    ->update([
        'actual_receiver_emp_no' => auth()->id(),
        'received_at' => now(),
        'movement_status' => 'received',
    ]);
8. TESTING REQUIREMENTS
Test Users:

php
// DatabaseSeeder.php
Registry Head: REGHEAD001 / Moha@2024 (can register files)
Registry Clerk: REGCLK001 / Clerk@2024 (can send files)
Department User: EMP002 / Password123 (can receive files)
Test Files:

MHA/1/1/1 - HEAD OF STATE matters

MHA/1/3/1 - PREROGATIVE OF MERCY (urgent)

MHA/1/6/1 - PUBLIC SERVICE POLICY (normal)

9. DEPLOYMENT COMMANDS SEQUENCE
bash
# 1. Initial Setup
composer create-project laravel/laravel .
composer require laravel/breeze --dev
php artisan breeze:install livewire
composer require livewire/livewire

# 2. Additional Packages
composer require barryvdh/laravel-dompdf
composer require simplesoftwareio/simple-qrcode

# 3. Frontend
npm install
npm install tailwindcss postcss autoprefixer
npx tailwindcss init -p

# 4. Database
php artisan migrate:fresh --seed
php artisan storage:link
php artisan key:generate

# 5. Build & Run
npm run build
php artisan serve
10. CONFIGURATION FILES TO MODIFY
A. .env (Key Variables):

env
APP_NAME="MOHA File Tracking System"
DB_CONNECTION=mysql
DB_HOST=127.0.0.1
DB_DATABASE=mohatracking
DB_USERNAME=root
DB_PASSWORD=
APP_URL=http://192.168.1.100
B. tailwind.config.js:

javascript
content: [
    "./app/Livewire/**/*.php",  // CRITICAL for Livewire
    "./resources/**/*.blade.php",
]
C. routes/web.php:

php
// Role-based routing
Route::middleware(['registry.head'])->group(...);
Route::middleware(['registry.staff'])->group(...);
11. COMMON PITFALLS TO AVOID
Livewire 3.x Issues: Use proper namespace App\Livewire\* not App\Http\Livewire\*

Employee Number Auth: Modify Breeze controllers to use employee_number not email

Database Relations: Foreign keys reference employee_number (string) not id (integer)

Local Network: Configure .env with server IP, not localhost

File Uploads: Set proper permissions for storage/ directory

12. VALIDATION RULES FOR FORMS
File Registration:

php
'subject' => 'required|string|max:500',
'file_title' => 'required|string|max:200',
'new_file_no' => 'required|unique:files',
'priority' => 'required|in:normal,urgent,very_urgent',
File Sending:

php
'intended_receiver_emp_no' => 'required|exists:employees,employee_number',
'delivery_method' => 'required|in:internal_messenger,hand_carry,courier',
13. PERFORMANCE CONSIDERATIONS
Database Indexing:

php
// On employees table
$table->index(['department', 'role']);
$table->index(['is_active', 'employee_number']);

// On files table
$table->index(['status', 'current_holder']);
$table->index(['new_file_no', 'old_file_no']);
Pagination: Use ->paginate(20) for all listings

Eager Loading: Use ->with(['currentHolder', 'latestMovement'])

14. SECURITY REQUIREMENTS
Role-Based Middleware:

registry.head: Can register files, manage users

registry.staff: Can send files, view all files

department.access: Can receive files, view department files

Audit Logging: Log all file movements, logins, changes

Data Validation: Validate all inputs, use prepared statements

XSS Protection: Blade templates automatically escape output

15. DELIVERABLE CHECKLIST
Minimum Viable Product (MVP):

Users can login with Employee Number

Registry Head can register new files

Registry Staff can send files to specific employees

Intended recipients receive notifications

Recipients can confirm receipt

File movement history is tracked

Files can be searched/tracked by file number

System works on local network (192.168.x.x)

Complete System:

All MVP features

Department dashboards

QR code generation for physical files

PDF report generation

Email notifications

Audit log viewing

User management (Registry Head only)

Backup/restore functionality

16. TESTING INSTRUCTIONS FOR AI AGENT
Test Scenario 1 - File Lifecycle:

bash
# 1. Login as Registry Head (REGHEAD001)
# 2. Register new file with subject "TEST FILE"
# 3. Logout

# 4. Login as Registry Clerk (REGCLK001)
# 5. Send file to Legal Officer (EMP002)
# 6. Logout

# 7. Login as Legal Officer (EMP002)
# 8. Confirm receipt of file
# 9. Verify timestamps recorded
Test Scenario 2 - Security:

bash
# 1. Login as Department User (EMP004)
# 2. Try to access registry-only routes (should fail)
# 3. Try to register file (should fail)
# 4. Verify can only see own department files
17. TROUBLESHOOTING GUIDE FOR AI
Issue: "Target class does not exist"

bash
# Solution:
composer dump-autoload
php artisan optimize:clear
# Check namespace in Livewire components: App\Livewire\*
Issue: "Authentication fails"

bash
# Solution:
# 1. Check Employee model uses employee_number as primary key
# 2. Verify login controller uses employee_number not email
# 3. Check employees have is_active = true
Issue: "Livewire component not found"

bash
# Solution:
# 1. Check file location: app/Livewire/ not app/Http/Livewire/
# 2. Check view location: resources/views/livewire/
# 3. Run: php artisan livewire:discover
ðŸš€ QUICK START FOR AI AGENT
Copy and paste this to the AI Agent:

text
BUILD A LARAVEL FILE TRACKING SYSTEM WITH THESE SPECS:

1. AUTH: Login with employee_number (not email). Employees table: employee_number(PK), name, position, department, role(registry_head,registry_clerk,department_head,user), is_active

2. CORE FEATURES:
   - Registry Head registers files (File: subject, file_title, old_file_no, new_file_no(unique), priority, confidentiality)
   - Registry Staff sends files to ONE intended receiver only
   - Receiver confirms receipt â†’ records timestamp
   - File status: at_registry â†’ in_transit â†’ received â†’ returned_to_registry
   - Track all movements with FileMovement table

3. TECH: Laravel 10, Livewire 3, MySQL, Tailwind CSS
4. DEPLOYMENT: Local office network (192.168.x.x), no internet needed

5. MVP PRIORITY:
   - Employee auth with employee_number
   - File registration (Registry Head only)
   - File sending with single recipient
   - Receipt confirmation
   - File tracking dashboard
   - Works on local network

Start with database migrations, then models, then Livewire components.
